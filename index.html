<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GoTon- PREMIUM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://sad.adsgram.ai/js/adsgram-ad-sdk.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, getDoc, setDoc, updateDoc, increment, onSnapshot, collection, addDoc, query, where, orderBy, limit, runTransaction } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyB2kfqxrUwMf5EFQ-WKAKWk8WWb1J5MZXM",
            authDomain: "ahmed-3b928.firebaseapp.com",
            projectId: "ahmed-3b928",
            storageBucket: "ahmed-3b928.firebasestorage.app",
            messagingSenderId: "942494598820",
            appId: "1:942494598820:web:97bd58fe0ab1d58d29c831",
            measurementId: "G-TMKTYHBZVW"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        const tg = window.Telegram?.WebApp;
        window.tg = tg; 

        // === [ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ≠ŸÖÿßŸäÿ© ÿßŸÑŸÖÿπÿ™ŸÖÿØŸá ŸÑŸÑÿßŸáÿ™ÿ≤ÿßÿ≤ - ŸÖÿØŸÖÿ¨] ===
        if (tg && tg.HapticFeedback) {
            const originalImpact = tg.HapticFeedback.impactOccurred;
            const originalNotification = tg.HapticFeedback.notificationOccurred;

            tg.HapticFeedback.impactOccurred = function(style) {
                if (tg.isVersionAtLeast('6.1')) {
                    originalImpact.call(tg.HapticFeedback, style);
                }
            };

            tg.HapticFeedback.notificationOccurred = function(type) {
                if (tg.isVersionAtLeast('6.1')) {
                    originalNotification.call(tg.HapticFeedback, type);
                }
            };
        }
        // ===========================================

        const userId = String(tg?.initDataUnsafe?.user?.id || "6472891");
        const referralId = tg?.initDataUnsafe?.start_param || null;

        let AdController = { show: () => Promise.resolve() };
        if (window.Adsgram) {
            AdController = window.Adsgram.init({ blockId: "4364" });
        }

        let userData = { balance: 0, refs: 0, adsCount: 3 };
        
        let GLOBAL_CONFIG = {
            mining_profit: 0.0001,
            mining_time: 3600,
            faucet_profit: 0.0001,
            faucet_time: 3600,
            ads_profit: 0.0001,
            ads_daily_limit: 3,
            ref_bonus: 0.0001,
            min_withdraw: 0.01 
        };

        function syncGlobalConfig() {
            onSnapshot(doc(db, "settings", "master"), (snap) => {
                if(snap.exists()) {
                    GLOBAL_CONFIG = snap.data();
                    updateUI(); 
                }
            });

            onSnapshot(doc(db, "settings", "notice"), (snap) => {
                if(snap.exists()) {
                    const data = snap.data();
                    if(data.text && tg) tg.showAlert("üì¢ SYSTEM NOTICE:\n\n" + data.text);
                }
            });
        }

        window.flyProfit = (cardId) => {
            const card = document.getElementById(cardId);
            const balanceEl = document.getElementById('main-balance');
            if(!card || !balanceEl) return;

            const cardRect = card.getBoundingClientRect();
            const balanceRect = balanceEl.getBoundingClientRect();

            for (let i = 0; i < 8; i++) {
                const particle = document.createElement('div');
                particle.className = 'fa-solid fa-gem fly-particle';
                particle.style.left = (cardRect.left + cardRect.width/2) + 'px';
                particle.style.top = (cardRect.top + cardRect.height/2) + 'px';
                
                const destinationX = (balanceRect.left + balanceRect.width/2) - (cardRect.left + cardRect.width/2);
                const destinationY = (balanceRect.top + balanceRect.height/2) - (cardRect.top + balanceRect.height/2);

                particle.style.setProperty('--destX', `${destinationX}px`);
                particle.style.setProperty('--destY', `${destinationY}px`);
                particle.style.animationDelay = (i * 0.1) + 's';

                document.body.appendChild(particle);
                setTimeout(() => particle.remove(), 1000);
            }
        };

        async function initApp() {
            syncGlobalConfig(); 
            const userRef = doc(db, "users", userId);
            const snap = await getDoc(userRef);

            if (!snap.exists()) {
                const initialData = { 
                    balance: 0, miningStart: 0, faucetStart: 0, 
                    adsCount: GLOBAL_CONFIG.ads_daily_limit, lastAdsTime: 0, adsResetTime: 0, 
                    adsRunning: false, refs: 0, 
                    invitedBy: (referralId && String(referralId) !== userId) ? String(referralId) : null,
                    username: tg?.initDataUnsafe?.user?.username || "Anonymous",
                    status: "active",
                    createdAt: Date.now()
                };
                
                await setDoc(userRef, initialData);

                if (referralId && String(referralId) !== userId) {
                    const inviterRef = doc(db, "users", String(referralId));
                    try {
                        await runTransaction(db, async (transaction) => {
                            const inviterSnap = await transaction.get(inviterRef);
                            if (inviterSnap.exists()) {
                                transaction.update(inviterRef, {
                                    balance: increment(GLOBAL_CONFIG.ref_bonus),
                                    refs: increment(1)
                                });
                            }
                        });
                    } catch(e) { console.log("Referral update error:", e); }
                }
            } else {
                if(snap.data().status === 'banned') {
                    document.body.innerHTML = "<div style='color:red; text-align:center; margin-top:50px;'>ACCOUNT BANNED</div>";
                    return;
                }
                checkOfflineProfits(snap.data());
            }

            onSnapshot(userRef, (d) => {
                if(d.exists()) {
                    userData = d.data();
                    updateUI();
                }
            });
            startAllTimers();
            loadWithdrawHistory();
            loadReferralList();
        }

        function checkOfflineProfits(data) {
            const now = Date.now();
            let totalToClaim = 0;
            const batchUpdate = {};

            if (data.miningStart > 0) {
                const elapsed = (now - data.miningStart) / 1000;
                if (elapsed >= GLOBAL_CONFIG.mining_time) {
                    totalToClaim += GLOBAL_CONFIG.mining_profit;
                    batchUpdate.miningStart = 0;
                }
            }
            if (data.faucetStart > 0) {
                const elapsed = (now - data.faucetStart) / 1000;
                if (elapsed >= GLOBAL_CONFIG.faucet_time) {
                    totalToClaim += GLOBAL_CONFIG.faucet_profit;
                    batchUpdate.faucetStart = 0;
                }
            }

            if (totalToClaim > 0) {
                batchUpdate.balance = increment(totalToClaim);
                updateDoc(doc(db, "users", userId), batchUpdate);
                showProfitModal(totalToClaim);
            }
        }

        window.createCoins = () => {
            for (let i = 0; i < 30; i++) {
                const coin = document.createElement('div');
                coin.className = 'coin-particle fa-solid fa-gem'; 
                coin.style.left = Math.random() * 100 + 'vw';
                coin.style.animationDuration = (Math.random() * 2 + 1) + 's';
                coin.style.fontSize = (Math.random() * 15 + 15) + 'px';
                coin.style.opacity = Math.random();
                document.body.appendChild(coin);
                setTimeout(() => coin.remove(), 3000);
            }
        };

        window.showProfitModal = (amount) => {
            const modal = document.getElementById('profit-modal');
            const display = document.getElementById('profit-amount-display');
            if(!modal || !display) return;
            display.innerText = Number(amount || 0).toFixed(5);
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            createCoins();
            if(tg?.HapticFeedback) tg.HapticFeedback.notificationOccurred('success');
        };

        window.closeProfitModal = () => {
            const modal = document.getElementById('profit-modal');
            if(modal) {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }
        };

        window.showPage = (pageId) => {
            document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
            const targetPage = document.getElementById(pageId);
            if(targetPage) targetPage.classList.remove('hidden');
            
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('text-[#ffd700]'));
            if(window.event && window.event.currentTarget) {
                window.event.currentTarget.classList.add('text-[#ffd700]');
            }
            
            if(tg?.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
            if(pageId === 'home-page') document.body.style.background = "#000000";
            if(pageId === 'friends-page') document.body.style.background = "#0d0216";
            if(pageId === 'withdraw-page') document.body.style.background = "#020b16";
        };

        window.copyRefLink = () => {
            const link = `https://t.me/Gotonfree_bot?start=${userId}`; 
            navigator.clipboard.writeText(link);
            if(tg) tg.showAlert("Link copied! Share it with your friends.");
        };

        function startAllTimers() {
            setInterval(syncMining, 100); 
            setInterval(syncFaucet, 100);
            setInterval(syncAds, 100);
        }

        window.startMining = async () => {
            if(userData.miningStart > 0) return;
            try { await AdController.show(); } catch (e) { console.log("Ad skipped"); }
            triggerEffect('mining-card');
            await updateDoc(doc(db, "users", userId), { miningStart: Date.now() });
        };

        function syncMining() {
            const card = document.getElementById('mining-card');
            const timer = document.getElementById('m-timer');
            const profit = document.getElementById('m-profit');
            if(!card || !timer || !profit) return;
            
            if (userData.miningStart > 0) {
                const el = (Date.now() - userData.miningStart)/1000;
                if(el >= GLOBAL_CONFIG.mining_time) {
                    flyProfit('mining-card'); 
                    updateDoc(doc(db, "users", userId), {balance: increment(GLOBAL_CONFIG.mining_profit), miningStart: 0});
                    showProfitModal(GLOBAL_CONFIG.mining_profit);
                } else {
                    card.classList.add('pulse-blue');
                    timer.innerText = formatTime(GLOBAL_CONFIG.mining_time - el);
                    profit.innerText = ((el/GLOBAL_CONFIG.mining_time) * GLOBAL_CONFIG.mining_profit).toFixed(7);
                }
            } else {
                card.classList.remove('pulse-blue');
                timer.innerText = "READY";
                profit.innerText = "0.0000000";
            }
        }

        window.claimFaucet = async () => {
            if(userData.faucetStart > 0) return;
            try { await AdController.show(); } catch (e) { console.log("Ad skipped"); }
            triggerEffect('faucet-card');
            await updateDoc(doc(db, "users", userId), { faucetStart: Date.now() });
        };

        function syncFaucet() {
            const card = document.getElementById('faucet-card');
            const machine = document.getElementById('machine-anim');
            const timer = document.getElementById('f-timer');
            const profit = document.getElementById('f-profit');
            if(!card || !timer || !profit) return;

            if (userData.faucetStart > 0) {
                const el = (Date.now() - userData.faucetStart)/1000;
                if(el >= GLOBAL_CONFIG.faucet_time) {
                    flyProfit('faucet-card'); 
                    updateDoc(doc(db,"users",userId), {balance: increment(GLOBAL_CONFIG.faucet_profit), faucetStart: 0});
                    if(machine) machine.classList.remove('active-mining');
                    showProfitModal(GLOBAL_CONFIG.faucet_profit);
                } else {
                    card.classList.add('pulse-gold');
                    if(machine) machine.classList.add('active-mining');
                    timer.innerText = formatTime(GLOBAL_CONFIG.faucet_time - el);
                    profit.innerText = ((el/GLOBAL_CONFIG.faucet_time) * GLOBAL_CONFIG.faucet_profit).toFixed(7);
                }
            } else {
                card.classList.remove('pulse-gold');
                if(machine) machine.classList.remove('active-mining');
                timer.innerText = "READY";
                profit.innerText = "0.0000000";
            }
        }

        window.watchAd = async function() {
            const now = Date.now();
            if (userData.adsCount === 0 && now >= userData.adsResetTime) {
                await updateDoc(doc(db, "users", userId), { adsCount: GLOBAL_CONFIG.ads_daily_limit, adsResetTime: 0, adsRunning: false });
                return;
            }
            if (userData.adsRunning || (userData.adsCount <= 0 && now < userData.adsResetTime)) return;
            
            try { await AdController.show(); } catch (e) { console.log("Ad error"); }
            
            triggerEffect('ads-card');
            await updateDoc(doc(db, "users", userId), { lastAdsTime: now, adsRunning: true });
        };

        function syncAds() {
            const card = document.getElementById('ads-card');
            const timer = document.getElementById('ads-timer');
            const profit = document.getElementById('a-profit');
            const btn = document.getElementById('ads-btn');
            if(!card || !timer || !profit || !btn) return;
            const now = Date.now();

            if (userData.adsRunning) {
                const elapsed = (now - userData.lastAdsTime) / 1000;
                if (elapsed >= 60) { 
                    finishAd();
                } else {
                    card.classList.add('pulse-green');
                    timer.innerText = formatTime(60 - elapsed);
                    profit.innerText = ((elapsed/60) * GLOBAL_CONFIG.ads_profit).toFixed(7);
                    btn.disabled = true;
                    btn.innerText = "RUNNING";
                }
            } else {
                card.classList.remove('pulse-green');
                btn.disabled = false;
                btn.innerText = "WATCH AD";
                profit.innerText = "0.0000000";
                if (userData.adsCount > 0) {
                    timer.innerHTML = `READY (<span id="ads-count">${userData.adsCount}</span>/${GLOBAL_CONFIG.ads_daily_limit})`;
                } else {
                    const remainingReset = Math.max(0, (userData.adsResetTime - now)/1000);
                    timer.innerText = remainingReset > 0 ? formatTime(remainingReset) : "RESETTING";
                }
            }
        }

        async function finishAd() {
            const now = Date.now();
            let nc = userData.adsCount - 1;
            let rt = (nc === 0) ? now + (24 * 3600 * 1000) : 0; 
            flyProfit('ads-card'); 
            await updateDoc(doc(db, "users", userId), { balance: increment(GLOBAL_CONFIG.ads_profit), adsCount: nc, adsRunning: false, adsResetTime: rt });
            if(tg?.HapticFeedback) tg.HapticFeedback.notificationOccurred('success');
            showProfitModal(GLOBAL_CONFIG.ads_profit);
        }

        function triggerEffect(id) {
            const el = document.getElementById(id);
            if(el) {
                el.style.transform = "scale(0.95)";
                setTimeout(() => el.style.transform = "scale(1)", 150);
            }
            if(tg?.HapticFeedback) tg.HapticFeedback.impactOccurred('medium');
        }

        function updateUI() {
            const balance = Number(userData?.balance || 0);
            const fb = balance.toFixed(5);
            
            const mb = document.getElementById('main-balance');
            const wb = document.getElementById('wallet-balance');
            const ac = document.getElementById('ads-count');
            const rc = document.getElementById('ref-count');
            const re = document.getElementById('ref-earnings');
            const refBonusText = document.getElementById('ref-bonus-text');

            if(mb) mb.innerText = fb;
            if(wb) wb.innerText = fb;
            if(ac) ac.innerText = userData.adsCount || 0;
            if(rc) rc.innerText = userData.refs || 0;
            if(re) re.innerText = ((userData.refs || 0) * (GLOBAL_CONFIG.ref_bonus || 0)).toFixed(4);
            if(refBonusText) refBonusText.innerText = (GLOBAL_CONFIG.ref_bonus || 0).toFixed(4);
        }

        function formatTime(sec) {
            const h = Math.floor(sec / 3600);
            const m = Math.floor((sec % 3600) / 60);
            const s = Math.floor(sec % 60);
            return h > 0 ? `${h}h ${m}m` : `${m}:${s < 10 ? '0'+s : s}`;
        }

        window.processWithdraw = async () => {
            const wallet = document.getElementById('withdraw-wallet').value;
            const amount = parseFloat(document.getElementById('withdraw-amount').value);
            const btn = document.querySelector("#withdraw-page button");

            if(!wallet || wallet.length < 5) { if(tg) tg.showAlert("Enter a valid wallet!"); return; }
            if(isNaN(amount) || amount < 0.01) { if(tg) tg.showAlert(`Min withdrawal is 0.01 TON`); return; }
            if(amount > (userData.balance || 0)) { if(tg) tg.showAlert("Insufficient balance!"); return; }
            
            try {
                btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Processing...';
                
                await updateDoc(doc(db, "users", userId), { balance: increment(-amount) });
                await addDoc(collection(db, "withdrawals"), { userId, wallet, amount, status: "Pending", date: Date.now() });

                const BOT_TOKEN = "8428693437:AAErFNnW_cmlrfgQMpqv70gcLbYmspDvzZI";
                const CHANNEL_ID = "@gotonpay"; 
                
                const shortWallet = wallet.substring(0, 5) + "..." + wallet.substring(wallet.length - 5);
                const userName = userData.username || "User_" + userId.substring(0,4);
                const dateStr = new Date().toLocaleString();

                const message = `
üåü **New Withdrawal Request!**
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üë§ **User:** ${userName}
üÜî **ID:** \`${userId}\`
üí∞ **Amount:** \`${amount.toFixed(4)} TON\`
üí≥ **Wallet:** \`${shortWallet}\`
üìÖ **Time:** ${dateStr}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚úÖ **Status:** Pending Review
ü§ñ [GoTon Bot](@Gotonfree_bot)
                `;

                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: CHANNEL_ID,
                        text: message,
                        parse_mode: "Markdown"
                    })
                });

                if(tg?.HapticFeedback) tg.HapticFeedback.notificationOccurred('success');
                showWithdrawSuccess();
                createCoins();
                
                btn.innerHTML = 'Request Withdrawal';
                document.getElementById('withdraw-amount').value = "";
            } catch(e) { 
                if(tg) tg.showAlert("Error Processing Request: " + e.message); 
                btn.innerHTML = 'Request Withdrawal';
            }
        };

        function showWithdrawSuccess() {
            const toast = document.createElement('div');
            toast.className = 'fixed top-10 left-1/2 -translate-x-1/2 bg-green-500 text-black px-6 py-3 rounded-full font-bold shadow-[0_0_20px_rgba(34,197,94,0.5)] z-[200] animate-bounce';
            toast.innerHTML = '<i class="fa-solid fa-check-circle mr-2"></i> Withdrawal Sent Successfully!';
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        function loadWithdrawHistory() {
            onSnapshot(collection(db, "withdrawals"), (snap) => {
                const list = document.getElementById('withdraw-history');
                if(!list) return;
                list.innerHTML = "";
                
                let myDocs = [];
                snap.forEach(d => {
                    const data = d.data();
                    if(String(data.userId) === String(userId)) myDocs.push(data);
                });

                myDocs.sort((a,b) => (b.date || 0) - (a.date || 0));

                myDocs.slice(0, 10).forEach(data => {
                    let statusClass = "bg-yellow-500/20 text-yellow-500"; 
                    const statusText = data.status || "Pending";

                    if (statusText === "Paid" || statusText === "Success" || statusText === "Confirmed") {
                        statusClass = "bg-green-500/20 text-green-500"; 
                    } else if (statusText === "Rejected" || statusText === "Failed" || statusText === "Cancelled") {
                        statusClass = "bg-red-500/20 text-red-500"; 
                    }

                    list.innerHTML += `
                        <div class="flex justify-between items-center bg-[#ffffff05] p-3 rounded-xl border border-[#ffffff10] mb-2 backdrop-blur-md">
                            <div class="text-left">
                                <p class="text-xs font-bold text-white">${Number(data.amount).toFixed(5)} TON</p>
                                <p class="text-[9px] text-gray-500">${new Date(data.date).toLocaleDateString()}</p>
                            </div>
                            <span class="text-[9px] px-2 py-1 rounded ${statusClass} font-bold uppercase">${statusText}</span>
                        </div>`;
                });
            });
        }

        function loadReferralList() {
            const q = query(collection(db, "users"), where("invitedBy", "==", userId), limit(50));
            onSnapshot(q, (snap) => {
                const list = document.getElementById('ref-list-container');
                if(!list) return;
                list.innerHTML = "";
                if(snap.empty) {
                    list.innerHTML = '<p class="text-[10px] text-gray-600 italic text-center">No friends joined yet...</p>';
                    return;
                }
                snap.forEach(d => {
                    const data = d.data();
                    list.innerHTML += `
                        <div class="flex justify-between items-center bg-white/5 p-2 rounded-lg border border-white/5 mb-1">
                            <div class="flex items-center gap-2">
                                <div class="w-6 h-6 rounded-full bg-[#c084fc30] flex items-center justify-center text-[10px] text-[#c084fc]">
                                    <i class="fa-solid fa-user"></i>
                                </div>
                                <span class="text-[10px] font-bold text-gray-300">ID: ${d.id.slice(0,8)}...</span>
                            </div>
                            <span class="text-[9px] text-green-500 font-bold">+${(GLOBAL_CONFIG.ref_bonus || 0).toFixed(4)} TON</span>
                        </div>`;
                });
            });
        }

        initApp();

        window.openFAQ = () => {
            const faq = document.getElementById('faq-modal');
            faq.classList.remove('hidden');
            faq.classList.add('flex');
        };

        window.closeFAQ = () => {
            const faq = document.getElementById('faq-modal');
            faq.classList.add('hidden');
            faq.classList.remove('flex');
        };
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap');
        body { background: #000; color: #fff; font-family: 'Cairo', sans-serif; padding: 15px; transition: background 0.5s ease; overflow-x: hidden; }
        
        .free-top-badge { position: absolute; top: 15px; left: 15px; background: #ffd700; color: #000; padding: 4px 12px; border-radius: 8px; font-size: 10px; font-weight: 900; text-transform: uppercase; box-shadow: 0 0 15px rgba(255, 215, 0, 0.4); z-index: 60; letter-spacing: 1px; }

        .fly-particle { position: fixed; color: #ffd700; font-size: 20px; z-index: 2000; pointer-events: none; animation: flyToBalance 0.8s cubic-bezier(0.6, -0.28, 0.735, 0.045) forwards; filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.8)); }

        @keyframes flyToBalance { 0% { transform: translate(0, 0) scale(1) rotate(0deg); opacity: 1; } 100% { transform: translate(var(--destX), var(--destY)) scale(0.2) rotate(720deg); opacity: 0; } }

        .coin-particle { position: fixed; top: -50px; color: #0088cc; z-index: 9999; pointer-events: none; animation: fall linear forwards; filter: drop-shadow(0 0 5px rgba(0, 136, 204, 0.8)); }
        @keyframes fall { to { transform: translateY(110vh) rotate(720deg); } }

        .neon-profit { color: #39FF14; font-weight: 900; text-shadow: 0 0 12px rgba(57, 255, 20, 0.8); }

        .card { background: radial-gradient(circle at top left, rgba(60, 60, 60, 0.4), rgba(10, 10, 10, 0.7)); border-radius: 1.5rem; padding: 15px; border: 1px solid rgba(255, 255, 255, 0.2); text-align: center; display: flex; flex-direction: column; justify-content: space-between; height: 190px; transition: 0.3s; position: relative; overflow: hidden; box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.05), 0 10px 20px rgba(0,0,0,0.6); backdrop-filter: blur(12px) saturate(180%); }

        .btn-gold { background: linear-gradient(to bottom, #ffd700, #ffae00); color: #000; font-weight: 900; border-radius: 1rem; width: 100%; padding: 10px; font-size: 11px; text-transform: uppercase; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3); border: none; cursor: pointer;}
        .nav-bar { background: rgba(11, 11, 11, 0.95); border-top: 1px solid rgba(255, 255, 255, 0.1); position: fixed; bottom: 0; left: 0; right: 0; display: flex; justify-content: space-around; padding: 12px; z-index: 100; backdrop-filter: blur(15px); }
        
        .pulse-blue { animation: pb 2s infinite; }
        .pulse-green { animation: pg 2s infinite; }
        .pulse-gold { animation: py 2s infinite; }

        @keyframes pb { 0%, 100% { border-color: rgba(59, 130, 246, 0.5); } 50% { border-color: #3b82f6; box-shadow: 0 0 25px rgba(59, 130, 246, 0.4), inset 0 0 15px rgba(59, 130, 246, 0.2); } }
        @keyframes pg { 0%, 100% { border-color: rgba(34, 197, 94, 0.5); } 50% { border-color: #22c55e; box-shadow: 0 0 25px rgba(34, 197, 94, 0.4), inset 0 0 15px rgba(34, 197, 94, 0.2); } }
        @keyframes py { 0%, 100% { border-color: rgba(255, 215, 0, 0.5); } 50% { border-color: #ffd700; box-shadow: 0 0 25px rgba(255, 215, 0, 0.4), inset 0 0 15px rgba(255, 215, 0, 0.2); } }

        .balance-card { background: linear-gradient(145deg, rgba(50, 50, 50, 0.9), rgba(10, 10, 10, 0.9)); border: 2px solid #ffd700; border-radius: 1.5rem; padding: 20px; text-align: center; margin-bottom: 20px; box-shadow: 0 10px 40px rgba(255, 215, 0, 0.2), inset 0 0 20px rgba(255, 215, 0, 0.1); }

        .machine-container { width: 100%; background: rgba(0,0,0,0.4); border-radius: 1rem; padding: 10px; display: flex; align-items: center; gap: 15px; border: 1px solid rgba(255,215,0,0.3); }
        .gear-box { position: relative; width: 50px; height: 50px; }
        .gear { position: absolute; color: #555; transition: 0.5s; }
        .gear-1 { top: 0; left: 10px; font-size: 25px; }
        .gear-2 { bottom: 5px; right: 10px; font-size: 18px; }
        .ton-coin-anim { font-size: 24px; color: #0088cc; position: absolute; top: 12px; left: 13px; z-index: 2; opacity: 0.5; }

        .active-mining .gear-1 { animation: spin 3s linear infinite; color: #ffd700; }
        .active-mining .gear-2 { animation: spin-rev 2s linear infinite; color: #ffd700; }
        .active-mining .ton-coin-anim { animation: float 2s ease-in-out infinite; opacity: 1; filter: drop-shadow(0 0 8px #0088cc); }

        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes spin-rev { from { transform: rotate(360deg); } to { transform: rotate(0deg); } }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }

        .display-screen { flex-grow: 1; background: #0a0a0a; border: 1px inset #333; border-radius: 8px; padding: 5px 10px; text-align: left; box-shadow: inset 0 0 15px #000; }
        .input-box { background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; padding: 12px; color: #fff; width: 100%; outline: none; transition: 0.3s; }
        
        #profit-modal, #faq-modal { transition: 0.5s; backdrop-filter: blur(20px); }
        .profit-content, .faq-content { background: linear-gradient(180deg, #1a1a1a, #000); animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        .ton-icon { font-size: 1.1em; color: #0088cc; vertical-align: middle; }
        .faq-btn { position: absolute; top: 15px; right: 15px; background: rgba(255, 215, 0, 0.1); border: 1px solid rgba(255, 215, 0, 0.3); padding: 8px 12px; border-radius: 12px; display: flex; align-items: center; gap: 6px; backdrop-filter: blur(10px); z-index: 50; color: #ffd700; font-size: 11px; font-weight: bold; }
        .faq-content { max-height: 85vh; overflow-y: auto; text-align: left; direction: ltr; }
        .tg-inner-box { background: rgba(0, 136, 204, 0.1); border: 1px dashed rgba(0, 136, 204, 0.5); border-radius: 15px; padding: 15px; margin-top: 15px; text-align: center; }
    </style>
</head>
<body class="pb-24">

    <div class="free-top-badge">free</div>

    <button onclick="openFAQ()" class="faq-btn">
        <i class="fa-solid fa-circle-question"></i>
        <span>FAQ</span>
    </button>

    <div id="faq-modal" class="fixed inset-0 z-[1100] hidden items-center justify-center bg-black/90 px-4">
        <div class="faq-content border border-yellow-500/30 rounded-[2rem] w-full p-6 relative">
            <h2 class="text-xl font-black text-yellow-500 mb-4 border-b border-white/10 pb-2 text-center">Frequently Asked Questions</h2>
            <div class="space-y-4 text-sm">
                <div><h3 class="font-bold text-blue-400">1. Who are we?</h3><p class="text-gray-300">We are a free earning company providing multiple ways to earn for free, which is our primary goal to help everyone.</p></div>
                <div><h3 class="font-bold text-blue-400">2. How does it work?</h3><p class="text-gray-300">Through cloud mining, faucets, and watching daily ads. Simply activate the available mining tools and wait for the timer to claim your rewards.</p></div>
                <div><h3 class="font-bold text-blue-400">3. Do we pay?</h3><p class="text-gray-300">Yes, we pay regularly. We have a dedicated payment channel to provide proof of payments for all users.</p></div>
                <div class="tg-inner-box !bg-green-500/5 !border-green-500/30">
                    <p class="text-[10px] text-green-400 mb-2 uppercase font-bold tracking-widest">Payment Proofs</p>
                    <a href="https://t.me/gotonpay" target="_blank" class="flex items-center justify-center gap-2 bg-green-600 text-white py-2 px-4 rounded-xl font-bold text-xs shadow-lg"><i class="fa-solid fa-receipt"></i>Check Proofs</a>
                </div>
                <div><h3 class="font-bold text-red-500">4. Important Warning!</h3><p class="text-gray-300">Multiple accounts or cheating in referrals is strictly forbidden. Any manipulation attempt will result in an immediate permanent ban.</p></div>
                <div class="tg-inner-box">
                    <p class="text-[10px] text-gray-400 mb-2 uppercase font-bold tracking-widest">Official Channel</p>
                    <a href="https://t.me/Gotonfree_bot" target="_blank" class="flex items-center justify-center gap-2 bg-[#0088cc] text-white py-2 px-4 rounded-xl font-bold text-xs shadow-lg"><i class="fa-brands fa-telegram text-lg"></i>Join Telegram Channel</a>
                </div>
            </div>
            <button onclick="closeFAQ()" class="btn-gold mt-6 !py-3">Close</button>
        </div>
    </div>

    <div id="profit-modal" class="fixed inset-0 z-[1000] hidden items-center justify-center bg-black/80 px-6">
        <div class="profit-content border-2 border-yellow-500 rounded-[2.5rem] w-full p-8 text-center relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-yellow-500 to-transparent"></div>
            <i class="fa-solid fa-gem text-6xl text-blue-500 mb-4 drop-shadow-[0_0_20px_rgba(0,136,204,0.6)]"></i>
            <h2 class="text-2xl font-black text-white uppercase tracking-tighter">Mining Success!</h2>
            <p class="text-gray-400 text-xs mb-6 uppercase tracking-widest">You have earned</p>
            <div class="bg-yellow-500/10 rounded-2xl py-4 border border-yellow-500/20 mb-8">
                <span id="profit-amount-display" class="text-4xl font-black neon-profit">0.00000</span>
                <span class="text-white font-bold"><i class="fa-solid fa-gem ton-icon"></i></span>
            </div>
            <button onclick="closeProfitModal()" class="btn-gold !py-4 !text-sm !rounded-2xl">Awesome, Claim Now!</button>
        </div>
    </div>

    <div id="home-page" class="page">
        <h1 class="text-center font-black text-xl text-[#ffd700] mb-5 uppercase tracking-widest">GoTon</h1>
        <div class="balance-card">
            <p class="text-[10px] text-gray-400 uppercase font-bold tracking-[0.2em]">Total Assets</p>
            <div class="flex items-center justify-center gap-2">
                <span id="main-balance" class="text-4xl font-black tracking-tighter neon-profit">0.00000</span>
                <span class="text-white font-bold text-xl"><i class="fa-solid fa-gem ton-icon"></i></span>
            </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
            <div id="mining-card" class="card">
                <div><i class="fa-solid fa-bolt-lightning text-blue-400 text-3xl mb-1 filter drop-shadow-[0_0_15px_rgba(96,165,250,0.6)]"></i><p class="text-[11px] font-bold uppercase">Cloud Mining</p><p id="m-timer" class="text-[10px] text-blue-400 font-mono">READY</p></div>
                <div class="text-[9px] text-gray-500 mb-2">Live: <span id="m-profit" class="neon-profit">0.0000000</span></div>
                <button onclick="startMining()" class="btn-gold">Start Now</button>
            </div>
            <div id="ads-card" class="card">
                <div><i class="fa-solid fa-clapperboard text-green-400 text-3xl mb-1 filter drop-shadow-[0_0_15px_rgba(74,222,128,0.6)]"></i><p class="text-[11px] font-bold uppercase">Ads Reward</p><p id="ads-timer" class="text-[10px] text-green-400 font-mono">READY (<span id="ads-count">0</span>/3)</p></div>
                <div class="text-[9px] text-gray-500 mb-2">Live: <span id="a-profit" class="neon-profit">0.0000000</span></div>
                <button id="ads-btn" onclick="watchAd()" class="btn-gold !bg-green-500 !text-black">Watch Ad</button>
            </div>
            <div id="faucet-card" class="card col-span-2 !h-auto !p-5">
                <div id="machine-anim" class="machine-container mb-4">
                    <div class="gear-box"><i class="fa-solid fa-gear gear gear-1"></i><i class="fa-solid fa-gear gear gear-2"></i><i class="fa-solid fa-gem ton-coin-anim"></i> </div>
                    <div class="display-screen">
                        <div class="flex justify-between items-center border-b border-white/5 mb-1 pb-1"><span class="text-[8px] text-gray-500 font-bold uppercase">Session</span><span id="f-timer" class="text-[10px] text-yellow-500 font-mono">READY</span></div>
                        <div class="flex justify-between items-center"><span class="text-[8px] text-gray-500 font-bold uppercase">Extracted</span><span id="f-profit" class="text-[12px] neon-profit font-mono font-bold">0.0000000</span></div>
                    </div>
                </div>
                <button onclick="claimFaucet()" class="btn-gold !py-4 shadow-[0_0_20px_rgba(255,215,0,0.2)]">Activate Extraction</button>
            </div>
        </div>
    </div>

    <div id="friends-page" class="page hidden">
        <h1 class="text-center font-black text-xl text-[#c084fc] mb-5 uppercase">Referral Awards</h1>
        <div class="grid grid-cols-2 gap-4 mb-4">
            <div class="card !border-[#c084fc40] !h-32"><i class="fa-solid fa-users text-[#c084fc] text-3xl"></i><h2 id="ref-count" class="text-2xl font-black mt-1">0</h2><p class="text-[9px] text-gray-500 uppercase">Team Size</p></div>
            <div class="card !border-[#c084fc40] !h-32"><i class="fa-solid fa-gift text-yellow-500 text-3xl"></i><h2 class="text-xl font-black mt-1 neon-profit"><span id="ref-earnings">0.0000</span></h2><p class="text-[9px] text-gray-500 uppercase">Total Bonus</p></div>
        </div>
        <div class="card col-span-2 !h-auto !py-8 !px-6 !border-[#c084fc60] mb-4">
            <p class="text-sm font-black uppercase">Invite & Earn TON</p>
            <p class="text-[10px] text-gray-400 mt-1 mb-4">Get <span id="ref-bonus-text" class="neon-profit">0.0001</span> per friend</p>
            <button onclick="copyRefLink()" class="btn-gold !bg-[#c084fc] !text-black !py-4">Share Invitation Link</button>
        </div>
        <div id="ref-list-container" class="space-y-2 max-h-[200px] overflow-y-auto px-1"></div>
    </div>

    <div id="withdraw-page" class="page hidden">
        <h1 class="text-center font-black text-xl text-[#60a5fa] mb-5 uppercase">Finance Center</h1>
        <div class="balance-card !border-[#60a5fa]">
            <span id="wallet-balance" class="text-3xl font-black neon-profit">0.00000</span>
        </div>
        <div class="card !h-auto !py-6 !gap-4 mb-5 !border-[#60a5fa55]">
            <input type="text" id="withdraw-wallet" class="input-box" placeholder="Enter TON address...">
            <input type="number" id="withdraw-amount" class="input-box" placeholder="0.01">
            <button onclick="processWithdraw()" class="btn-gold !bg-[#60a5fa] !text-white !py-4">Request Withdrawal</button>
        </div>
        <div id="withdraw-history" class="space-y-2 px-2"></div>
    </div>

    <nav class="nav-bar">
        <button onclick="showPage('home-page')" class="nav-btn text-[#ffd700] flex flex-col items-center"><i class="fa-solid fa-microchip text-xl"></i><span class="text-[9px] font-bold mt-1 uppercase">Mining</span></button>
        <button onclick="showPage('friends-page')" class="nav-btn text-gray-500 flex flex-col items-center"><i class="fa-solid fa-gift text-xl"></i><span class="text-[9px] font-bold mt-1 uppercase">Referral</span></button>
        <button onclick="showPage('withdraw-page')" class="nav-btn text-gray-500 flex flex-col items-center"><i class="fa-solid fa-wallet text-xl"></i><span class="text-[9px] font-bold mt-1 uppercase">Wallet</span></button>
    </nav>

    <script>
        if (window.Telegram?.WebApp) {
            window.Telegram.WebApp.expand();
            window.Telegram.WebApp.ready();
        }
    </script>
</body>
</html>
